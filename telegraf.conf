# Telegraf Configuration for macOS Metrics
# Sends system metrics to InfluxDB v2

[agent]
  ## Default data collection interval for all inputs
  interval = "5s"
  ## Rounds collection interval to 'interval'
  round_interval = true
  ## Telegraf will send metrics to outputs in batches
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  ## Collection jitter used to jitter the collection by a random amount
  collection_jitter = "0s"
  ## Default flushing interval for all outputs
  flush_interval = "5s"
  flush_jitter = "0s"
  ## Precision of writes
  precision = "0s"
  ## Override default hostname
  hostname = ""
  ## If set to true, do no set the "host" tag in the telegraf agent
  omit_hostname = false

###############################################################################
#                            OUTPUT PLUGINS                                   #
###############################################################################

# Configuration for sending metrics to InfluxDB 2.0
[[outputs.influxdb_v2]]
  ## InfluxDB v2 URL
  urls = ["http://localhost:8334"]

  ## Token for authentication
  token = "mytoken123"

  ## Organization is the name of the organization you wish to write to
  organization = "myorg"

  ## Destination bucket to write into
  bucket = "mybucket"

  ## Timeout for HTTP messages
  timeout = "5s"

###############################################################################
#                            INPUT PLUGINS                                    #
###############################################################################

# Read metrics about cpu usage
[[inputs.cpu]]
  ## Whether to report per-cpu stats or not
  percpu = true
  ## Whether to report total system cpu stats or not
  totalcpu = true
  ## If true, collect raw CPU time metrics
  collect_cpu_time = false
  ## If true, compute and report the sum of all non-idle CPU states
  report_active = false
  ## If true and the info is available then add core_id and physical_id tags
  core_tags = false

# Read metrics about disk usage by mount point
[[inputs.disk]]
  ## Ignore mount points by filesystem type
  ignore_fs = ["tmpfs", "devtmpfs", "devfs", "iso9660", "overlay", "aufs", "squashfs"]

# Read metrics about disk IO by device
[[inputs.diskio]]

# Get kernel statistics from /proc/stat (Linux-specific, may not work on macOS)
# [[inputs.kernel]]

# Read metrics about memory usage
[[inputs.mem]]

# Get the number of processes and group them by status
[[inputs.processes]]

# Read metrics about swap memory usage
[[inputs.swap]]

# Read metrics about system load & uptime
[[inputs.system]]

# Read metrics about network interface usage
[[inputs.net]]
  ## By default, telegraf gathers stats from any up interface (excluding loopback)
  ## Setting interfaces will tell it to gather these explicit interfaces,
  ## regardless of status.
  # interfaces = ["eth0"]
  ## On linux systems telegraf also collects protocol stats.
  ignore_protocol_stats = false

# Read TCP metrics such as established, time wait and sockets counts
[[inputs.netstat]]

# Collect statistics about itself
[[inputs.internal]]
  ## If true, collect telegraf memory stats
  collect_memstats = true

# Collect per-process CPU and memory metrics
[[inputs.procstat]]
  ## Monitor all processes (use pattern ".*" to match all)
  ## This collects CPU and memory usage per process
  pattern = ".*"
  ## Add pid as a tag for tracking individual processes (new syntax)
  tag_with = ["pid", "cmdline"]
  ## Fields to collect - CPU and memory related (new syntax)
  fieldinclude = ["cpu_usage", "memory_rss", "memory_vms", "memory_swap", "num_threads", "read_bytes", "write_bytes"]
